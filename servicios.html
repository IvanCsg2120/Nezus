<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Servicios T√©cnicos - Nexus Pro</title>
  <link rel="stylesheet" href="css/servicio.css" />
  <link rel="stylesheet" href="css/dashboard.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

</head>
<body>

  <!-- ==========================================
       SIDEBAR LATERAL CON LOGO Y NAVEGACI√ìN
  ========================================== -->
  <aside class="sidebar">
    <!-- Header del Sidebar CON LOGO Y NAVEGACI√ìN AL INICIO -->
    <div class="sidebar-header" onclick="irAlInicio()" title="Ir al Inicio">
      <div class="sidebar-logo">
        <!-- TU LOGO AQU√ç -->
        <img src="img/logo.png" alt="Nexus Pro Logo" class="logo-sidebar">
      </div>
      <div class="sidebar-title">
        <h2>Nexus Pro</h2>
        <p>v.0.2.34</p>
      </div>
    </div>

    <!-- Usuario con bot√≥n + -->
    <div class="sidebar-user">
      <img src="https://ui-avatars.com/api/?name=Juan+Sanchez&background=22CA95&color=fff&bold=true" 
           alt="Usuario" class="user-avatar-sidebar">
      <div class="user-info-sidebar">
        <h3 id="sidebarUserName">Juan S√°nchez</h3>
        <p id="sidebarUserRole">Administrador</p>
      </div>
      <div class="add-btn" title="Nuevo" onclick="openNewProjectModal()">
        <i class="fas fa-plus"></i>
      </div>
    </div>

    <!-- Secci√≥n M√≥dulos -->
    <div class="nav-section">
      <div class="nav-section-title">M√≥dulos</div>
      <a href="clientes.html" class="nav-item">
        <i class="fas fa-users"></i>
        <span>Clientes</span>
        <span class="nav-badge" id="navBadgeClientes">24</span>
      </a>
      <a href="servicios.html" class="nav-item active">
        <i class="fas fa-cogs"></i>
        <span>Servicios</span>
        <span class="nav-badge" id="navBadgeServicios">15</span>
      </a>
      <a href="cotizaciones.html" class="nav-item">
        <i class="fas fa-file-contract"></i>
        <span>Cotizaciones</span>
        <span class="nav-badge" id="navBadgeCotizaciones">32</span>
      </a>
      <a href="facturacion.html" class="nav-item">
        <i class="fas fa-file-invoice"></i>
        <span>Facturaci√≥n</span>
      </a>
      <a href="calendario.html" class="nav-item">
        <i class="fas fa-calendar-alt"></i>
        <span>Calendario</span>
      </a>
    </div>

    <!-- Footer del Sidebar -->
    <div class="sidebar-footer">
      <div class="version-info">
        <div class="version-icon">
          <i class="fas fa-rocket"></i>
        </div>
        <div class="version-text">
          <h4>NexusCaster</h4>
          <p>ver. 0.2.34</p>
        </div>
        <button class="version-menu">
          <i class="fas fa-ellipsis-h"></i>
        </button>
      </div>
    </div>
  </aside>

  <!-- ==========================================
       CONTENIDO PRINCIPAL
  ========================================== -->
  <main class="main-wrapper">
    
    <!-- Header Superior del Contenido -->
    <header class="content-topbar">
      <div class="topbar-left">
        <button class="menu-toggle" onclick="toggleSidebar()">
          <i class="fas fa-bars"></i>
        </button>
        <div class="search-bar">
          <i class="fas fa-search"></i>
          <input type="text" placeholder="Buscar servicios..." id="searchInput">
        </div>
      </div>

      <div class="topbar-right">
        <div class="topbar-actions">
          <button class="action-btn" title="Notificaciones" onclick="toggleNotifications()">
            <i class="fas fa-bell"></i>
            <span class="action-badge">3</span>
          </button>
          <button class="action-btn" title="Mensajes" onclick="toggleMessages()">
            <i class="fas fa-envelope"></i>
            <span class="action-badge">5</span>
          </button>
          <button class="action-btn" title="Configuraci√≥n" onclick="window.location.href='settings.html'">
            <i class="fas fa-cog"></i>
          </button>
        </div>
        
        <button class="logout-btn" onclick="logout()">
          <i class="fas fa-sign-out-alt"></i>
        </button>
      </div>
    </header>

    <!-- Contenido de Servicios -->
    <div class="dashboard-content">
      
      <section class="servicios-hero">
        <h1>Servicios T√©cnicos Profesionales</h1>
        <p>Soluciones tecnol√≥gicas de alta calidad respaldadas por a√±os de experiencia y cientos de clientes satisfechos</p>
      </section>

      <div class="servicios-stats">
        <div class="stat-card">
          <div class="stat-numero">12+</div>
          <div class="stat-label">Servicios Especializados</div>
        </div>
        <div class="stat-card">
          <div class="stat-numero">500+</div>
          <div class="stat-label">Clientes Satisfechos</div>
        </div>
        <div class="stat-card">
          <div class="stat-numero">98%</div>
          <div class="stat-label">Tasa de √âxito</div>
        </div>
        <div class="stat-card">
          <div class="stat-numero">24/7</div>
          <div class="stat-label">Soporte Prioritario</div>
        </div>
      </div>

      <main class="container">
        <section class="card">
          <h2>Cat√°logo de Servicios</h2>
          <p class="small">Explore nuestra gama completa de servicios t√©cnicos profesionales. Cada soluci√≥n est√° dise√±ada para resolver problemas espec√≠ficos con la m√°xima eficiencia y calidad garantizada.</p>

          <!-- Bot√≥n para servicio personalizado -->
          <div style="margin:20px 0 25px 0; text-align: center;">
            <button class="btn-outline" onclick="solicitarServicioPersonalizado()">
              <i class="fas fa-lightbulb"></i>
              ¬øNecesita un servicio personalizado? Cont√°ctenos
            </button>
          </div>

          <!-- Filtros -->
          <div class="servicios-filtros">
            <div class="filtro-grupo">
              <label for="searchInputServicios"><i class="fas fa-search"></i> Buscar servicio</label>
              <input type="text" id="searchInputServicios" placeholder="Ej: mantenimiento, reparaci√≥n...">
            </div>
            <div class="filtro-grupo">
              <label for="categoriaFiltro"><i class="fas fa-filter"></i> Categor√≠a</label>
              <select id="categoriaFiltro">
                <option value="todos">Todos los servicios</option>
                <option value="hardware">Hardware</option>
                <option value="software">Software</option>
                <option value="seguridad">Seguridad</option>
                <option value="soporte">Soporte</option>
                <option value="redes">Redes</option>
              </select>
            </div>
          </div>

          <!-- Contenedor din√°mico -->
          <div id="catalogoServicios" class="catalogo-servicios" aria-live="polite"></div>
        </section>
      </main>

      <!-- Modal para detalles del servicio -->
      <div id="modalServicio" class="modal-servicio">
        <!-- Contenido din√°mico -->
      </div>
    </div>
  </main>

  <script>
    // ==========================================
    // FUNCI√ìN PARA IR AL INICIO
    // ==========================================
    function irAlInicio() {
      // Aqu√≠ defines a qu√© p√°gina debe llevar el inicio
      // Puede ser dashboard.html, index.html, o la p√°gina principal de tu aplicaci√≥n
      window.location.href = 'dashboard.html'; // Cambia por tu p√°gina de inicio
      
      // Opcional: Mostrar notificaci√≥n de navegaci√≥n
      mostrarNotificacion('üè† Redirigiendo al inicio...', 'success');
    }

    // Configuraci√≥n de servicios mejorada
    const serviciosConfig = {
        iconos: {
            "Mantenimiento Preventivo PC": "fas fa-laptop-medical",
            "Formateo e Instalaci√≥n SO": "fas fa-desktop", 
            "Remoci√≥n de Malware": "fas fa-shield-virus",
            "Soporte Remoto (por hora)": "fas fa-headset",
            "Reparaci√≥n de Pantallas": "fas fa-tablet-alt",
            "Instalaci√≥n de Redes": "fas fa-network-wired",
            "Recuperaci√≥n de Datos": "fas fa-hdd",
            "Optimizaci√≥n de Sistema": "fas fa-tachometer-alt",
            "Backup y Cloud": "fas fa-cloud-upload-alt",
            "Consultor√≠a IT": "fas fa-chart-line",
            "default": "fas fa-tools"
        },
        descripciones: {
            "Mantenimiento Preventivo PC": "Limpieza f√≠sica interna completa, optimizaci√≥n de sistema y revisi√≥n de componentes para garantizar el m√°ximo rendimiento y extender la vida √∫til del equipo.",
            "Formateo e Instalaci√≥n SO": "Formateo completo e instalaci√≥n limpia del sistema operativo con todos los controladores necesarios, actualizaciones y configuraci√≥n b√°sica para un rendimiento √≥ptimo.",
            "Remoci√≥n de Malware": "Eliminaci√≥n completa de virus, malware y recuperaci√≥n del sistema afectado con medidas de protecci√≥n adicional para prevenir futuras infecciones.",
            "Soporte Remoto (por hora)": "Asistencia t√©cnica remota profesional para resoluci√≥n inmediata de problemas desde la comodidad de su hogar u oficina.",
            "Reparaci√≥n de Pantallas": "Servicio profesional de reemplazo de pantallas para laptops, tablets y monitores utilizando componentes de alta calidad con garant√≠a.",
            "Instalaci√≥n de Redes": "Planificaci√≥n completa de red, instalaci√≥n de equipos, configuraci√≥n de seguridad y optimizaci√≥n de se√±al para entornos dom√©sticos y empresariales.",
            "Recuperaci√≥n de Datos": "Recuperaci√≥n avanzada de datos desde unidades da√±adas, eliminaci√≥n accidental o corrupci√≥n del sistema con altas tasas de √©xito.",
            "Optimizaci√≥n de Sistema": "An√°lisis completo del sistema y ajustes avanzados para mejorar significativamente el rendimiento y la velocidad.",
            "Backup y Cloud": "Soluciones de backup seguro y servicios de migraci√≥n a la nube para proteger sus datos valiosos y garantizar la continuidad del negocio.",
            "Consultor√≠a IT": "Consultor√≠a estrat√©gica de TI para optimizar su infraestructura tecnol√≥gica y alinearla con sus objetivos comerciales.",
            "default": "Servicio t√©cnico profesional personalizado para sus necesidades y requisitos espec√≠ficos."
        },
        caracteristicas: {
            "Mantenimiento Preventivo PC": ["Limpieza interna completa", "Optimizaci√≥n de sistema", "Revisi√≥n de componentes", "Diagn√≥stico completo", "Garant√≠a 30 d√≠as"],
            "Formateo e Instalaci√≥n SO": ["Formateo completo", "Instalaci√≥n limpia de SO", "Todos los drivers", "Configuraci√≥n b√°sica", "Antivirus incluido"],
            "Remoci√≥n de Malware": ["Escaneo completo", "Eliminaci√≥n de amenazas", "Restauraci√≥n de sistema", "Protecci√≥n adicional", "Informe detallado"],
            "Soporte Remoto (por hora)": ["Asistencia en tiempo real", "Soluci√≥n de problemas", "Instalaci√≥n de software", "Configuraci√≥n de apps", "Seguimiento post-servicio"],
            "Reparaci√≥n de Pantallas": ["Diagn√≥stico gratuito", "Pantallas de calidad", "Garant√≠a 90 d√≠as", "Servicio r√°pido", "Presupuesto previo"],
            "Instalaci√≥n de Redes": ["Planificaci√≥n de red", "Equipos certificados", "Configuraci√≥n seguridad", "Optimizaci√≥n se√±al", "Documentaci√≥n t√©cnica"],
            "Recuperaci√≥n de Datos": ["Diagn√≥stico gratuito", "M√∫ltiples m√©todos", "Alta tasa de √©xito", "Confidencialidad", "Entrega segura"],
            "Optimizaci√≥n de Sistema": ["An√°lisis completo", "Ajustes avanzados", "Mejora velocidad", "Mantenimiento", "Reporte de mejoras"],
            "Backup y Cloud": ["Estrategia backup", "Soluciones cloud", "Encriptaci√≥n datos", "Monitoreo 24/7", "Recuperaci√≥n r√°pida"],
            "Consultor√≠a IT": ["Auditor√≠a completa", "Plan estrat√©gico", "Optimizaci√≥n costos", "Roadmap tecnol√≥gico", "Soporte ejecutivo"],
            "default": ["Servicio personalizado", "Profesional certificado", "Garant√≠a de calidad", "Soporte post-servicio"]
        }
    };

    // Datos de servicios mejorados
    const servicios = [
        { id: 1, nombre: "Mantenimiento Preventivo PC", precio: 35.00, categoria: "hardware", duracion: "2-3 horas", popular: true, garantia: "30 d√≠as" },
        { id: 2, nombre: "Formateo e Instalaci√≥n SO", precio: 50.00, categoria: "software", duracion: "3-4 horas", garantia: "60 d√≠as" },
        { id: 3, nombre: "Remoci√≥n de Malware", precio: 45.00, categoria: "seguridad", duracion: "1-2 horas", nuevo: true, garantia: "90 d√≠as" },
        { id: 4, nombre: "Soporte Remoto (por hora)", precio: 20.00, categoria: "soporte", duracion: "1 hora", popular: true, garantia: "Incluida" },
        { id: 5, nombre: "Reparaci√≥n de Pantallas", precio: 80.00, categoria: "hardware", duracion: "1-2 d√≠as", garantia: "90 d√≠as" },
        { id: 6, nombre: "Instalaci√≥n de Redes", precio: 65.00, categoria: "redes", duracion: "2-3 horas", garantia: "60 d√≠as" },
        { id: 7, nombre: "Recuperaci√≥n de Datos", precio: 75.00, categoria: "software", duracion: "2-5 d√≠as", nuevo: true, garantia: "Servicio" },
        { id: 8, nombre: "Optimizaci√≥n de Sistema", precio: 30.00, categoria: "software", duracion: "1-2 horas", garantia: "30 d√≠as" },
        { id: 9, nombre: "Backup y Cloud", precio: 55.00, categoria: "software", duracion: "3-4 horas", oferta: true, garantia: "Continuo" },
        { id: 10, nombre: "Consultor√≠a IT", precio: 90.00, categoria: "soporte", duracion: "Personalizado", garantia: "Seguimiento" }
    ];

    let serviciosFiltrados = [...servicios];

    // Utilidades mejoradas
    function escapeHtml(str) {
        if (!str && str !== 0) return "";
        return String(str)
            .replace(/&/g, "&amp;")
            .replace(/</g, "&lt;")
            .replace(/>/g, "&gt;")
            .replace(/"/g, "&quot;")
            .replace(/'/g, "&#39;");
    }

    function formatPrice(num) {
        return Number(num || 0).toLocaleString('es-ES', {
            minimumFractionDigits: 2,
            maximumFractionDigits: 2
        });
    }

    // Modal de servicios mejorado
    function abrirModalServicio(servicio) {
        const modal = document.getElementById("modalServicio");
        const caracteristicas = serviciosConfig.caracteristicas[servicio.nombre] || serviciosConfig.caracteristicas.default;
        const icono = serviciosConfig.iconos[servicio.nombre] || serviciosConfig.iconos.default;
        
        modal.innerHTML = `
            <div class="modal-contenido">
                <div class="modal-header">
                    <h2><i class="${icono}" style="margin-right: 10px;"></i>${escapeHtml(servicio.nombre)}</h2>
                    <button class="btn-cerrar-modal" onclick="cerrarModal()">√ó</button>
                </div>
                <div class="modal-body">
                    <div style="display: flex; gap: 30px; margin-bottom: 25px; flex-wrap: wrap;">
                        <div style="flex: 1; min-width: 280px;">
                            <div class="servicio-imagen">
                                <i class="${icono}"></i>
                            </div>
                        </div>
                        <div style="flex: 2; min-width: 320px;">
                            <div class="servicio-categoria">${servicio.categoria.charAt(0).toUpperCase() + servicio.categoria.slice(1)}</div>
                            <p style="color: #666; margin-bottom: 20px; line-height: 1.6;">${escapeHtml(serviciosConfig.descripciones[servicio.nombre] || serviciosConfig.descripciones.default)}</p>
                            
                            <div style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); padding: 20px; border-radius: 12px; margin-bottom: 20px; border-left: 4px solid var(--mountain-meadow);">
                                <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
                                    <div>
                                        <strong style="color: var(--forest); font-size: 28px;">$${formatPrice(servicio.precio)}</strong>
                                        <span style="color: #666; margin-left: 10px; font-size: 14px;">${servicio.duracion}</span>
                                    </div>
                                    <div style="background: rgba(34, 202, 149, 0.1); padding: 8px 16px; border-radius: 20px; color: var(--forest); font-weight: 600; font-size: 14px;">
                                        <i class="fas fa-shield-alt"></i> Garant√≠a: ${servicio.garantia || "30 d√≠as"}
                                    </div>
                                </div>
                            </div>
                            
                            <h3 style="margin-bottom: 15px; color: var(--dark-green); font-size: 1.3rem;"><i class="fas fa-check-circle" style="color: var(--mountain-meadow);"></i> Caracter√≠sticas del servicio:</h3>
                            <div class="servicio-caracteristicas">
                                ${caracteristicas.map(c => `
                                    <div class="servicio-caracteristica">
                                        <i class="fas fa-check" style="color: var(--pistachio);"></i>
                                        <span>${c}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 15px; justify-content: flex-end; margin-top: 25px; flex-wrap: wrap;">
                        <button onclick="agregarACotizacion(${JSON.stringify(servicio).replace(/"/g, '&quot;')})" 
                                class="btn-contratar" style="padding: 14px 28px; font-size: 1.05rem;">
                            <i class="fas fa-shopping-cart"></i>
                            Agregar a Cotizaci√≥n
                        </button>
                        <button onclick="cerrarModal()" 
                                class="btn-detalles" style="padding: 14px 28px; font-size: 1.05rem;">
                            <i class="fas fa-times"></i>
                            Cancelar
                        </button>
                    </div>
                </div>
            </div>
        `;
        
        modal.style.display = 'flex';
        
        // Agregar animaci√≥n de entrada
        setTimeout(() => {
            modal.querySelector('.modal-contenido').style.transform = 'translateY(0) scale(1)';
            modal.querySelector('.modal-contenido').style.opacity = '1';
        }, 10);
    }

    function cerrarModal() {
        const modal = document.getElementById("modalServicio");
        if (modal) {
            modal.querySelector('.modal-contenido').style.transform = 'translateY(20px) scale(0.95)';
            modal.querySelector('.modal-contenido').style.opacity = '0';
            setTimeout(() => {
                modal.style.display = 'none';
            }, 300);
        }
    }

    function agregarACotizacion(servicio) {
        const seleccionados = JSON.parse(localStorage.getItem("serviciosSeleccionados") || "[]");
        
        // Verificar si el servicio ya est√° en la cotizaci√≥n
        const existe = seleccionados.find(s => s.servicioId === servicio.id);
        if (existe) {
            existe.cantidad += 1;
        } else {
            seleccionados.push({
                servicioId: servicio.id,
                nombre: servicio.nombre,
                precio: servicio.precio,
                cantidad: 1,
                categoria: servicio.categoria
            });
        }
        
        localStorage.setItem("serviciosSeleccionados", JSON.stringify(seleccionados));
        cerrarModal();
        
        // Mostrar notificaci√≥n mejorada
        mostrarNotificacion(`‚úÖ "${servicio.nombre}" agregado a cotizaci√≥n`, 'success');
        
        // Actualizar badge de cotizaciones
        actualizarBadgeCotizaciones();
    }

    function mostrarNotificacion(mensaje, tipo = 'success') {
        const notificacion = document.createElement('div');
        const bgColor = tipo === 'success' ? 'var(--mountain-meadow)' : '#FF6B6B';
        
        notificacion.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: ${bgColor};
            color: white;
            padding: 16px 24px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            z-index: 1001;
            font-weight: 600;
            transition: all 0.4s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            max-width: 400px;
            transform: translateX(100px);
            opacity: 0;
        `;
        
        notificacion.innerHTML = `
            <i class="fas fa-${tipo === 'success' ? 'check-circle' : 'exclamation-triangle'}"></i>
            <span>${mensaje}</span>
        `;
        
        document.body.appendChild(notificacion);
        
        // Animaci√≥n de entrada
        setTimeout(() => {
            notificacion.style.transform = 'translateX(0)';
            notificacion.style.opacity = '1';
        }, 10);
        
        // Remover despu√©s de 4 segundos
        setTimeout(() => {
            notificacion.style.transform = 'translateX(100px)';
            notificacion.style.opacity = '0';
            setTimeout(() => {
                if (document.body.contains(notificacion)) {
                    document.body.removeChild(notificacion);
                }
            }, 400);
        }, 4000);
    }

    function actualizarBadgeCotizaciones() {
        const seleccionados = JSON.parse(localStorage.getItem("serviciosSeleccionados") || "[]");
        const totalItems = seleccionados.reduce((sum, item) => sum + item.cantidad, 0);
        
        const badge = document.getElementById('navBadgeCotizaciones');
        if (badge) {
            badge.textContent = totalItems;
        }
    }

    // Renderizar cat√°logo mejorado
    function renderizarCatalogo(servicios) {
        const contenedor = document.getElementById("catalogoServicios");
        if (!contenedor) return;
        
        if (!servicios || servicios.length === 0) {
            contenedor.innerHTML = `
                <div style="grid-column: 1/-1; text-align: center; padding: 60px 20px;">
                    <i class="fas fa-search" style="font-size: 4rem; color: #cbd5e1; margin-bottom: 20px;"></i>
                    <h3 style="color: #64748b; margin-bottom: 10px;">No se encontraron servicios</h3>
                    <p style="color: #94a3b8;">Intenta ajustar los filtros o t√©rminos de b√∫squeda</p>
                </div>
            `;
            return;
        }
        
        let html = '';
        servicios.forEach(servicio => {
            const descripcion = serviciosConfig.descripciones[servicio.nombre] || serviciosConfig.descripciones.default;
            const caracteristicas = serviciosConfig.caracteristicas[servicio.nombre] || serviciosConfig.caracteristicas.default;
            const icono = serviciosConfig.iconos[servicio.nombre] || serviciosConfig.iconos.default;
            
            html += `
                <div class="servicio-card">
                    ${servicio.popular ? '<div class="servicio-badge popular">Popular</div>' : ''}
                    ${servicio.nuevo ? '<div class="servicio-badge nuevo">Nuevo</div>' : ''}
                    ${servicio.oferta ? '<div class="servicio-badge oferta">Oferta</div>' : ''}
                    
                    <div class="servicio-imagen">
                        <i class="${icono}"></i>
                    </div>
                    
                    <div class="servicio-contenido">
                        <div class="servicio-categoria">${servicio.categoria.charAt(0).toUpperCase() + servicio.categoria.slice(1)}</div>
                        <h3 class="servicio-titulo">${escapeHtml(servicio.nombre)}</h3>
                        <p class="servicio-descripcion">${escapeHtml(descripcion)}</p>
                        
                        <div class="servicio-caracteristicas">
                            ${caracteristicas.slice(0, 3).map(c => `
                                <div class="servicio-caracteristica">
                                    <i class="fas fa-check" style="color: var(--pistachio);"></i>
                                    <span>${c}</span>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div class="servicio-precio">
                            <div>
                                <span class="precio-actual">$${formatPrice(servicio.precio)}</span>
                            </div>
                            <div class="servicio-duracion">
                                <i class="far fa-clock"></i>
                                <span>${servicio.duracion}</span>
                            </div>
                        </div>
                        
                        <div class="servicio-acciones">
                            <button class="btn-servicio btn-contratar" onclick="abrirModalServicio(${JSON.stringify(servicio).replace(/"/g, '&quot;')})">
                                <i class="fas fa-shopping-cart"></i>
                                Solicitar
                            </button>
                            <button class="btn-servicio btn-detalles" onclick="abrirModalServicio(${JSON.stringify(servicio).replace(/"/g, '&quot;')})">
                                <i class="fas fa-info-circle"></i>
                                Detalles
                            </button>
                        </div>
                    </div>
                </div>
            `;
        });
        
        contenedor.innerHTML = html;
    }

    // Filtros y b√∫squeda mejorados
    function aplicarFiltros() {
        const busqueda = document.getElementById("searchInputServicios")?.value.toLowerCase() || "";
        const categoria = document.getElementById("categoriaFiltro")?.value || "todos";
        
        serviciosFiltrados = [...servicios];
        
        // Filtrar por categor√≠a
        if (categoria !== "todos") {
            serviciosFiltrados = serviciosFiltrados.filter(s => 
                s.categoria?.toLowerCase() === categoria.toLowerCase()
            );
        }
        
        // Filtrar por b√∫squeda
        if (busqueda) {
            serviciosFiltrados = serviciosFiltrados.filter(s =>
                s.nombre.toLowerCase().includes(busqueda) ||
                (serviciosConfig.descripciones[s.nombre] || "").toLowerCase().includes(busqueda) ||
                s.categoria.toLowerCase().includes(busqueda)
            );
        }
        
        renderizarCatalogo(serviciosFiltrados);
    }

    // Servicio personalizado mejorado
    function solicitarServicioPersonalizado() {
        const servicioPersonalizado = prompt("Por favor, describe el servicio que necesitas. Incluye detalles como:\n\n‚Ä¢ Tipo de equipo/problema\n‚Ä¢ S√≠ntomas espec√≠ficos\n‚Ä¢ Urgencia del servicio\n‚Ä¢ Presupuesto aproximado\n\nNuestro equipo se contactar√° contigo en menos de 2 horas h√°biles:");
        
        if (servicioPersonalizado && servicioPersonalizado.trim() !== "") {
            // Simular env√≠o profesional
            mostrarNotificacion("üìß Tu solicitud ha sido enviada a nuestro equipo t√©cnico. Te contactaremos pronto.", 'success');
            
            // En un entorno real, aqu√≠ se enviar√≠a a un sistema de tickets
            setTimeout(() => {
                mostrarNotificacion("üë®‚Äçüíª Nuestro t√©cnico asignado revisar√° tu solicitud y te contactar√° para coordinar una soluci√≥n.", 'success');
            }, 2000);
        }
    }

    // Funciones de la barra lateral
    function toggleSidebar() {
        document.querySelector('.sidebar').classList.toggle('collapsed');
        document.querySelector('.main-wrapper').classList.toggle('sidebar-collapsed');
    }

    function logout() {
        if (confirm("¬øEst√°s seguro de que deseas cerrar sesi√≥n?")) {
            localStorage.removeItem("sessionUser");
            localStorage.removeItem("usuarioLogueado");
            window.location.href = "index.html";
        }
    }

    function toggleNotifications() {
        mostrarNotificacion("üîî No hay nuevas notificaciones pendientes.", 'success');
    }

    function toggleMessages() {
        mostrarNotificacion("üí¨ Sistema de mensajes en desarrollo - Pr√≥ximamente", 'success');
    }

    function openNewProjectModal() {
        mostrarNotificacion("üÜï Funci√≥n de nuevo proyecto en desarrollo", 'success');
    }

    // Inicializaci√≥n mejorada
    document.addEventListener("DOMContentLoaded", function() {
        // Verificar sesi√≥n
        const s = localStorage.getItem("sessionUser");
        if (!s) { 
            location.href = "index.html"; 
            return; 
        }

        const user = JSON.parse(s);
        
        // Actualizar informaci√≥n del usuario en sidebar
        document.getElementById("sidebarUserName").textContent = user.nombre || "Usuario";
        document.getElementById("sidebarUserRole").textContent = user.rol || "Administrador";

        // Inicializar badges
        actualizarBadgeCotizaciones();
        
        // Renderizar servicios con efecto de carga
        setTimeout(() => {
            renderizarCatalogo(servicios);
            serviciosFiltrados = [...servicios];
        }, 300);
        
        // Event listeners para filtros
        const searchInput = document.getElementById("searchInputServicios");
        const categoriaSelect = document.getElementById("categoriaFiltro");
        
        if (searchInput) {
            searchInput.addEventListener("input", aplicarFiltros);
        }
        
        if (categoriaSelect) {
            categoriaSelect.addEventListener("change", aplicarFiltros);
        }
        
        // Cerrar modal al hacer clic fuera o presionar ESC
        window.addEventListener("click", function(event) {
            const modal = document.getElementById("modalServicio");
            if (event.target === modal) {
                cerrarModal();
            }
        });
        
        window.addEventListener("keydown", function(event) {
            if (event.key === "Escape") {
                cerrarModal();
            }
        });
        
        // Efecto de carga inicial
        document.getElementById("catalogoServicios").innerHTML = `
            <div style="grid-column: 1/-1; display: grid; grid-template-columns: repeat(auto-fill, minmax(380px, 1fr)); gap: 2rem;">
                ${Array(6).fill(0).map(() => `
                    <div class="servicio-card loading-skeleton" style="min-height: 450px; background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%); background-size: 200% 100%; animation: loading 1.5s infinite;"></div>
                `).join('')}
            </div>
        `;
    });
  </script>
</body>
</html>